<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Timeout test</title>
    <style>
      #trigger { border: 1 px solid red }
      #bottomDiv { background-color: green; }
      .invisible {visibility: hidden; opacity: 0; transition: visibility 300ms, opacity 300ms }
      .visible {visibility: visible; opacity: 1; transition: opacity 300ms }
    </style>
  </head>
  <body>
    <div id="trigger">
      Hover here to open the box
    </div>
    <div id="bottomDiv" class="invisible">
      I am the bottom div
    </div>
    <script type="text/javascript">
      let trigger = document.querySelector("#trigger")
      let bottomDiv = document.querySelector("#bottomDiv")

      let openTimer = () => {
        window.openID = setTimeout(() => {
          bottomDiv.className = "visible";
        }, 1000)
      }
      let closeTimer = () => {
        window.closeID = setTimeout(() => {
          bottomDiv.className = "invisible";
        }, 1000)
      }


      trigger.addEventListener('mouseenter', () => {
        console.log("entered trigger");
        openTimer();
        if (window.closeID) {
          clearTimeout(closeID);
        }
      });
      trigger.addEventListener('mouseleave', () => {
        console.log("exited trigger")
        if (window.openID) {
          clearTimeout(openID);
        }
        closeTimer();
      });

      bottomDiv.addEventListener('mouseenter', () => {
        console.log('entered bottomDiv')
        if (window.closeID) {
          clearTimeout(closeID);
        }
      })

      bottomDiv.addEventListener('mouseleave', () => {
        console.log('exited bottomDiv')
        closeTimer();
      })

    </script>
  </body>
</html>
